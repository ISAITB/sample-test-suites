<?xml version="1.0" encoding="UTF-8"?>
<testcase id="sample_test_case" xmlns="http://www.gitb.com/tdl/v1/" xmlns:gitb="http://www.gitb.com/core/v1/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.gitb.com/tdl/v1/ ../../gitb_tdl.xsd">
    <metadata>
        <gitb:name>Sample test case</gitb:name>
        <gitb:version>1.0</gitb:version>
        <gitb:description>Test case illustrating a sample use of the template service sample implementations.</gitb:description>
    </metadata>
    <variables>
        <var name="messageToSend" type="string"/>
    </variables>
    <actors>
        <gitb:actor id="actor1" name="Actor 1" role="SUT"/>
        <gitb:actor id="actor2" name="Actor 2"/>
    </actors>
    <steps>
        <!--
            Request the message to send to the messaging service.
        -->
        <interact desc="Request message">
            <request desc="Enter the message to send:">$messageToSend</request>
        </interact>
        <!--
            Send the message.
        -->
        <send id="step1" desc="Send message" from="actor1" to="actor2" handler="$DOMAIN{messagingServiceAddress}">
            <input name="messageToSend">$messageToSend</input>
        </send>
        <!--
            Receive a response message.
            This is provided by calling http://localhost:8080/input?message=text.
        -->
        <receive id="step2" desc="Receive message" from="actor2" to="actor1" handler="$DOMAIN{messagingServiceAddress}"/>
        <etxn txnId="t1"/>
        <!--
            Convert the received message to uppercase.
        -->
        <process id="result" handler="$DOMAIN{processingServiceAddress}">
            <operation>uppercase</operation>
            <input name="input">$step2{messageReceived}</input>
        </process>
        <!--
            Check to see that the uppercased message matches "HELLO!"
        -->
        <verify handler="$DOMAIN{validationServiceAddress}" desc="Validate text">
            <input name="text">$result{output}</input>
            <input name="expected">'HELLO!'</input>
        </verify>
    </steps>
</testcase>